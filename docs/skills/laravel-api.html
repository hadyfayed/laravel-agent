---
layout: page
title: laravel-api
description: Build REST APIs with versioning and OpenAPI documentation
nav_active: Skills
back_url: /skills.html
back_text: All Skills
---

<div class="mb-8">
    <div class="flex items-center gap-4 mb-4">
        <div class="w-12 h-12 rounded-[var(--radius)] bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
        </div>
        <div>
            <h1 class="text-3xl font-bold">laravel-api</h1>
            <p class="text-muted-foreground">Auto-invoked skill</p>
        </div>
    </div>
    <p class="text-xl text-muted-foreground">Build REST APIs with versioning and OpenAPI documentation</p>
</div>

<div class="prose prose-neutral dark:prose-invert max-w-none">
    <h2>Trigger Keywords</h2>
    <p>This skill automatically activates when Claude detects these keywords:</p>
    <div class="flex flex-wrap gap-2 not-prose mb-6">
        <span class="trigger-tag">api</span>
        <span class="trigger-tag">rest</span>
        <span class="trigger-tag">endpoint</span>
        <span class="trigger-tag">openapi</span>
        <span class="trigger-tag">json</span>
        <span class="trigger-tag">resource</span>
    </div>

    <h2>Overview</h2>
    <p>The <strong>laravel-api</strong> skill provides expertise for building production-ready REST APIs. When activated, Claude understands API versioning strategies, JSON resource transformations, rate limiting, authentication, and OpenAPI documentation.</p>

    <h2>What This Skill Provides</h2>
    <ul>
        <li><strong>API Versioning</strong> - URL-based (/api/v1/) or header-based versioning</li>
        <li><strong>JSON Resources</strong> - Proper response transformation with relationships</li>
        <li><strong>Request Validation</strong> - Form requests with API-specific error formatting</li>
        <li><strong>Rate Limiting</strong> - Per-user and per-endpoint throttling</li>
        <li><strong>Authentication</strong> - Sanctum, Passport, or API key strategies</li>
        <li><strong>Documentation</strong> - OpenAPI/Swagger spec generation</li>
    </ul>

    <h2>Example Conversations</h2>
    <pre class="language-bash"><code class="language-bash"># Building a new API
"I need to create a REST API for managing products with filtering and pagination"

# Adding versioning
"Help me version my API - I need to support v1 and v2 simultaneously"

# Response formatting
"How should I structure my API responses for a collection with pagination?"

# Authentication
"Set up Sanctum authentication for my API with token abilities"</code></pre>

    <h2>JSON Resource Implementation</h2>
    <p>Transform your models into consistent API responses:</p>
    <pre class="language-php"><code class="language-php">&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Request;
use Illuminate\Http\Resources\Json\JsonResource;

class ProductResource extends JsonResource
{
    public function toArray(Request $request): array
    {
        return [
            'id' =&gt; $this-&gt;id,
            'name' =&gt; $this-&gt;name,
            'slug' =&gt; $this-&gt;slug,
            'price' =&gt; [
                'amount' =&gt; $this-&gt;price,
                'formatted' =&gt; number_format($this-&gt;price, 2),
                'currency' =&gt; 'USD',
            ],
            'in_stock' =&gt; $this-&gt;stock_quantity &gt; 0,

            // Conditional relationships - only included if loaded
            'category' =&gt; new CategoryResource($this-&gt;whenLoaded('category')),
            'reviews' =&gt; ReviewResource::collection($this-&gt;whenLoaded('reviews')),

            // Conditional counts
            'reviews_count' =&gt; $this-&gt;whenCounted('reviews'),

            // Conditional fields based on user
            'cost' =&gt; $this-&gt;when($request-&gt;user()?-&gt;isAdmin(), $this-&gt;cost),

            'created_at' =&gt; $this-&gt;created_at-&gt;toISOString(),
        ];
    }

    // Wrap single resources
    public function with(Request $request): array
    {
        return [
            'meta' =&gt; [
                'api_version' =&gt; 'v1',
            ],
        ];
    }
}</code></pre>

    <h2>Resource Collection with Custom Pagination</h2>
    <pre class="language-php"><code class="language-php">&lt;?php

namespace App\Http\Resources;

use Illuminate\Http\Request;
use Illuminate\Http\Resources\Json\ResourceCollection;

class ProductCollection extends ResourceCollection
{
    public $collects = ProductResource::class;

    public function toArray(Request $request): array
    {
        return [
            'data' =&gt; $this-&gt;collection,
            'meta' =&gt; [
                'total' =&gt; $this-&gt;total(),
                'per_page' =&gt; $this-&gt;perPage(),
                'current_page' =&gt; $this-&gt;currentPage(),
                'last_page' =&gt; $this-&gt;lastPage(),
                'has_more' =&gt; $this-&gt;hasMorePages(),
            ],
        ];
    }
}

// Usage in controller
public function index(Request $request)
{
    $products = Product::query()
        -&gt;with(['category', 'reviews'])
        -&gt;withCount('reviews')
        -&gt;when($request-&gt;category, fn ($q, $cat) =&gt; $q-&gt;where('category_id', $cat))
        -&gt;when($request-&gt;search, fn ($q, $s) =&gt; $q-&gt;where('name', 'like', "%{$s}%"))
        -&gt;paginate($request-&gt;per_page ?? 15);

    return new ProductCollection($products);
}</code></pre>

    <h2>API Response Patterns</h2>
    <p>The skill ensures consistent response structures:</p>
    <pre class="language-json"><code class="language-json">// Collection response with pagination
{
    "data": [
        {"id": 1, "name": "Product 1", "price": {"amount": 29.99}},
        {"id": 2, "name": "Product 2", "price": {"amount": 49.99}}
    ],
    "meta": {
        "total": 100,
        "per_page": 15,
        "current_page": 1,
        "last_page": 7,
        "has_more": true
    },
    "links": {
        "first": "/api/v1/products?page=1",
        "last": "/api/v1/products?page=7",
        "next": "/api/v1/products?page=2",
        "prev": null
    }
}

// Error response (422 Validation)
{
    "message": "The given data was invalid.",
    "errors": {
        "email": ["The email field is required."],
        "password": ["The password must be at least 8 characters."]
    }
}</code></pre>

    <h2>API Versioning Setup</h2>
    <pre class="language-php"><code class="language-php">&lt;?php

// routes/api.php - URL-based versioning (recommended)
use Illuminate\Support\Facades\Route;

Route::prefix('v1')-&gt;group(function () {
    Route::apiResource('products', App\Http\Controllers\Api\V1\ProductController::class);
    Route::apiResource('orders', App\Http\Controllers\Api\V1\OrderController::class);
});

Route::prefix('v2')-&gt;group(function () {
    Route::apiResource('products', App\Http\Controllers\Api\V2\ProductController::class);
});

// app/Http/Controllers/Api/V1/ProductController.php
namespace App\Http\Controllers\Api\V1;

use App\Http\Controllers\Controller;
use App\Http\Resources\V1\ProductResource;
use App\Models\Product;

class ProductController extends Controller
{
    public function index()
    {
        return ProductResource::collection(
            Product::with('category')-&gt;paginate()
        );
    }

    public function show(Product $product)
    {
        return new ProductResource($product-&gt;load('category', 'reviews'));
    }
}</code></pre>

    <h2>Rate Limiting Configuration</h2>
    <pre class="language-php"><code class="language-php">&lt;?php

// app/Providers/AppServiceProvider.php
use Illuminate\Cache\RateLimiting\Limit;
use Illuminate\Support\Facades\RateLimiter;

public function boot(): void
{
    // Default API rate limit
    RateLimiter::for('api', function ($request) {
        return Limit::perMinute(60)-&gt;by($request-&gt;user()?-&gt;id ?: $request-&gt;ip());
    });

    // Stricter limit for expensive operations
    RateLimiter::for('exports', function ($request) {
        return Limit::perHour(10)-&gt;by($request-&gt;user()-&gt;id);
    });

    // Different limits by subscription tier
    RateLimiter::for('tiered', function ($request) {
        $user = $request-&gt;user();

        return match ($user?-&gt;subscription_tier) {
            'enterprise' =&gt; Limit::none(),
            'pro' =&gt; Limit::perMinute(1000)-&gt;by($user-&gt;id),
            default =&gt; Limit::perMinute(100)-&gt;by($user?-&gt;id ?: $request-&gt;ip()),
        };
    });
}

// Apply in routes
Route::middleware(['throttle:api'])-&gt;group(function () {
    Route::apiResource('products', ProductController::class);
});

Route::middleware(['throttle:exports'])-&gt;group(function () {
    Route::get('/export/orders', [ExportController::class, 'orders']);
});</code></pre>

    <h2>Sanctum API Authentication</h2>
    <pre class="language-php"><code class="language-php">&lt;?php

// routes/api.php
Route::post('/auth/token', function (Request $request) {
    $request-&gt;validate([
        'email' =&gt; 'required|email',
        'password' =&gt; 'required',
        'device_name' =&gt; 'required',
    ]);

    $user = User::where('email', $request-&gt;email)-&gt;first();

    if (!$user || !Hash::check($request-&gt;password, $user-&gt;password)) {
        throw ValidationException::withMessages([
            'email' =&gt; ['The provided credentials are incorrect.'],
        ]);
    }

    // Create token with abilities (permissions)
    $token = $user-&gt;createToken($request-&gt;device_name, [
        'products:read',
        'products:write',
        'orders:read',
    ]);

    return response()-&gt;json([
        'token' =&gt; $token-&gt;plainTextToken,
        'expires_at' =&gt; now()-&gt;addDays(30)-&gt;toISOString(),
    ]);
});

// Protected routes
Route::middleware('auth:sanctum')-&gt;group(function () {
    Route::get('/user', fn (Request $request) =&gt; $request-&gt;user());

    // Check token abilities
    Route::middleware('ability:products:write')-&gt;group(function () {
        Route::post('/products', [ProductController::class, 'store']);
        Route::put('/products/{product}', [ProductController::class, 'update']);
    });
});</code></pre>

    <h2>Testing API Endpoints</h2>
    <pre class="language-php"><code class="language-php">&lt;?php

use App\Models\Product;
use App\Models\User;

it('lists products with pagination', function () {
    Product::factory()-&gt;count(20)-&gt;create();

    $response = $this-&gt;getJson('/api/v1/products?per_page=10');

    $response
        -&gt;assertOk()
        -&gt;assertJsonCount(10, 'data')
        -&gt;assertJsonStructure([
            'data' =&gt; [['id', 'name', 'price']],
            'meta' =&gt; ['total', 'per_page', 'current_page'],
        ]);
});

it('requires authentication for protected routes', function () {
    $this-&gt;postJson('/api/v1/products', ['name' =&gt; 'Test'])
        -&gt;assertUnauthorized();
});

it('creates product with valid token', function () {
    $user = User::factory()-&gt;create();
    $token = $user-&gt;createToken('test', ['products:write'])-&gt;plainTextToken;

    $response = $this-&gt;withToken($token)
        -&gt;postJson('/api/v1/products', [
            'name' =&gt; 'New Product',
            'price' =&gt; 29.99,
        ]);

    $response-&gt;assertCreated()
        -&gt;assertJsonPath('data.name', 'New Product');
});

it('respects rate limits', function () {
    $user = User::factory()-&gt;create();

    // Exhaust rate limit
    for ($i = 0; $i &lt; 60; $i++) {
        $this-&gt;actingAs($user)-&gt;getJson('/api/v1/products');
    }

    // Next request should be rate limited
    $this-&gt;actingAs($user)
        -&gt;getJson('/api/v1/products')
        -&gt;assertStatus(429);
});</code></pre>

    <h2>Common Patterns</h2>
    <div class="overflow-x-auto not-prose">
        <table class="w-full text-sm">
            <thead>
                <tr class="border-b border-border">
                    <th class="text-left py-3 px-4 font-medium">Pattern</th>
                    <th class="text-left py-3 px-4 font-medium">When to Use</th>
                </tr>
            </thead>
            <tbody>
                <tr class="border-b border-border">
                    <td class="py-3 px-4"><code>JsonResource</code></td>
                    <td class="py-3 px-4">Single model transformation</td>
                </tr>
                <tr class="border-b border-border">
                    <td class="py-3 px-4"><code>ResourceCollection</code></td>
                    <td class="py-3 px-4">Collections with custom pagination</td>
                </tr>
                <tr class="border-b border-border">
                    <td class="py-3 px-4"><code>whenLoaded()</code></td>
                    <td class="py-3 px-4">Conditional relationship inclusion</td>
                </tr>
                <tr class="border-b border-border">
                    <td class="py-3 px-4"><code>QueryBuilder</code></td>
                    <td class="py-3 px-4">Filtering, sorting, including via query params</td>
                </tr>
            </tbody>
        </table>
    </div>

    <h2>Common Pitfalls</h2>
    <ul>
        <li><strong>N+1 in resources</strong> - Always eager load relationships before transforming</li>
        <li><strong>Exposing sensitive data</strong> - Explicitly define what to include, don't use <code>toArray()</code></li>
        <li><strong>Inconsistent errors</strong> - Use exception handlers for uniform error responses</li>
        <li><strong>Missing rate limits</strong> - Always protect public endpoints</li>
    </ul>

    <h2>Related Commands</h2>
    <ul>
        <li><a href="{{ '/commands/api-make.html' | relative_url }}" class="text-primary hover:underline">/laravel-agent:api:make</a> - Create API resources</li>
        <li><a href="{{ '/commands/api-docs.html' | relative_url }}" class="text-primary hover:underline">/laravel-agent:api:docs</a> - Generate OpenAPI documentation</li>
    </ul>

    <h2>Related Agent</h2>
    <ul>
        <li><a href="{{ '/agents/laravel-api-builder.html' | relative_url }}" class="text-primary hover:underline">laravel-api-builder</a> - Builds complete API resources</li>
    </ul>
</div>
